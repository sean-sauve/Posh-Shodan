#  .ExternalHelp Posh-Shodan.Help.xml
function Measure-ShodanExploit {
    [CmdletBinding(
        DefaultParameterSetName = 'Direct'
    )]
    param (
        # Shodan developer API key
        [String]
        $ApiKey,

        [String]
        $CertificateThumbprint,

        [Parameter(ParameterSetName = 'Proxy', Mandatory)]
        [String]
        $Proxy,

        [Parameter(ParameterSetName = 'Proxy')]
        [Management.Automation.PSCredential]
        $ProxyCredential,

        [Parameter(ParameterSetName = 'Proxy')]
        [Switch]
        $ProxyUseDefaultCredentials,

        # List of properties to get summary information on
        [ValidateSet('author', 'platform', 'port', 'source', 'type')]
        [string[]]
        $Facets,

        # Search query used to search the database of known exploits
        [Parameter(Mandatory)]
        [string]
        $Query
    )
    begin {
        $Body = @{
            'query' = $Query
        }
        $InvokeParameters = @{
            'Method'     = 'GET'
            'Uri'        = 'https://exploits.shodan.io/api/count'
            'PSTypeName' = 'Shodan.Exploit.Count'
            'Body'       = $Body
        }
        $InvokeParameters = Add-ShodanPassthroughParameter -FromHashtable $PSBoundParameters -ToHashTable $InvokeParameters
    }
    process {
        Invoke-ShodanRestMethod @InvokeParameters
    }
    end {
    }
}
